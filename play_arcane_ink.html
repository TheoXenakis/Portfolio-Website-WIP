<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Theo Xenakis | Game Designer</title>
    <link rel="stylesheet" href="style.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>
</head>
<body>
<div class="grain-overlay"></div>
<nav class="navbar">
  <div class="logo"><a href="index.html">Theo Xenakis</a></div>
  <button class="hamburger" aria-label="Open navigation" aria-controls="navLinks" aria-expanded="false"><span></span><span></span><span></span></button>
  <ul class="nav-links" id="navLinks">
    <li><a href="index.html">Work</a></li>
    <li><a href="about.html">About</a></li>
    <li><a href="contact.html">Contact</a></li>
    <li><a href="resume/Resume-Game-Design-Focus.pdf">Resume</a></li>
  </ul>
</nav>
<div id="game-container"></div>

<script>
// Navbar hamburger
const hamburger = document.querySelector('.hamburger');
const navLinks = document.querySelector('.nav-links');
hamburger.addEventListener('click', function() {
    navLinks.classList.toggle('show');
    if (navLinks.classList.contains('show')) {
        document.addEventListener('click', function outsideClickListener(event) {
            if (!navLinks.contains(event.target) && !hamburger.contains(event.target)) {
                navLinks.classList.remove('show');
                document.removeEventListener('click', outsideClickListener);
                hamburger.setAttribute('aria-expanded', 'false');
            }
        });
    }
    this.setAttribute('aria-expanded', navLinks.classList.contains('show'));
});
</script>

<script>
var config = {
    type: Phaser.AUTO,
    width: 1000,
    height: 600,
    parent: 'game-container',
    pixelArt: true,
    backgroundColor: '#1c2c4c',
    scene: {
        preload: preload,
        create: create,
        update: update
    },
    physics: { default: 'arcade' },
    scale: {
        mode: Phaser.Scale.FIT,
        autoCenter: Phaser.Scale.CENTER_BOTH
    }
};

const gridOffsetX = 90;
const gridOffsetY = 205;
const cellSize = 32;
const gridRows = 3;
const gridCols = 9;
let grid = [];

function createGrid() {
    for (let row = 0; row < gridRows; row++) {
        grid[row] = [];
        for (let col = 0; col < gridCols; col++) {
            grid[row][col] = {
                x: col * cellSize + gridOffsetX,
                y: row * cellSize + gridOffsetY,
                occupied: false,
                graphics: null // Reference to fill graphics for this cell
            };
        }
    }
}
createGrid();

function drawGridOutlines(scene) {
    const graphics = scene.add.graphics();
    graphics.lineStyle(2, 0xffffff, 0.2);
    for (let row = 0; row < gridRows; row++) {
        for (let col = 0; col < gridCols; col++) {
            const cell = grid[row][col];
            graphics.strokeRect(cell.x, cell.y, cellSize, cellSize);
        }
    }
}

function getCellUnderPointer(pointer) {
    const mouseX = pointer.x;
    const mouseY = pointer.y;
    for (let row = 0; row < gridRows; row++) {
        for (let col = 0; col < gridCols; col++) {
            const cell = grid[row][col];
            if (
                mouseX >= cell.x &&
                mouseX < cell.x + cellSize &&
                mouseY >= cell.y &&
                mouseY < cell.y + cellSize
            ) {
                return cell;
            }
        }
    }
    return null;
}

function preload() {
    this.load.spritesheet('castle-anim', 'assets/castle-anim.png', { frameWidth: 70, frameHeight: 130 });
    this.load.image('plains-ground', 'assets/plains-ground.png');
    this.load.image('Tree', 'assets/Tree.png');
    this.load.spritesheet('flag-anim', 'assets/flag-anim.png', { frameWidth: 32, frameHeight: 64 });

    this.load.image('bowman_icon', 'assets/bowman.png');
}

function create() {
    this.add.image(250, 300, 'plains-ground');
    this.anims.create({
        key: 'castleIdle',
        frames: this.anims.generateFrameNumbers('castle-anim', { start: 0, end: 5 }),
        frameRate: 5,
        repeat: -1
    });
    var castle = this.add.sprite(455, 225, 'castle-anim');
    castle.play('castleIdle');
    this.anims.create({
        key: 'flagWave',
        frames: this.anims.generateFrameNumbers('flag-anim', { start: 0, end: 6 }),
        frameRate: 6,
        repeat: -1
    });
    var flag1 = this.add.sprite(600, 150, 'flag-anim');
    var flag2 = this.add.sprite(300, 150, 'flag-anim');
    flag1.play('flagWave');
    flag2.play('flagWave');

    var bowmanIcon = this.add.image(800, 40, 'bowman_icon').setScale(1.5);

    // Draw the grid overlays
    drawGridOutlines(this);

    // Listen for clicks to fill/unfill grid cells
    this.input.on('pointerdown', function(pointer) {
        const cell = getCellUnderPointer(pointer);
        if (cell) {
            // Remove any old fill graphics for this cell
            if (cell.graphics) {
                cell.graphics.destroy();
                cell.graphics = null;
            }
            // Fill for (un)occupied
            cell.occupied = !cell.occupied;
            if (cell.occupied) {
                cell.graphics = this.add.graphics();
                cell.graphics.fillStyle(0xff0000, 0.3);
                cell.graphics.fillRect(cell.x, cell.y, cellSize, cellSize);
            } else {
                cell.graphics = this.add.graphics();
                cell.graphics.fillStyle(0xffffff, 0.15);
                cell.graphics.fillRect(cell.x, cell.y, cellSize, cellSize);
            }
        }
    }, this);
}

function update() {}
var game = new Phaser.Game(config);
</script>
</body>
</html>
